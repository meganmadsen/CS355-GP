{% extends 'base.html' %}

{% block style%}
<style>
#resume {
   opacity: 0;
   position: absolute;
   z-index: -1;
}
#transcript {
   opacity: 0;
   position: absolute;
   z-index: -1;
}

label {
   cursor: pointer;
   /* Style as you please, it will become the visible UI component. */
}
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="card">
    <div class="card-body">
      <div class="d-flex align-items-center">
        <div class="avatar me-3">
          <img src="{{ session['avatar_img_path'] }}" alt="{{ session['first_n'] }}" class="rounded-circle" style="width: 64px; height: 64px;">
        </div>
        <div>
          <h5 class="card-title">{{ session['first_n'] + ' ' + session['last_n'] }}</h5>
          <p class="card-text">
            {# Following: {{  }} users<br> #}
            {# Followed by: {{ user.followers|length }} users #}
          </p>
        </div>
      </div>
      <hr>
      <div class="row">
      <form action="./update_prof" method="POST">
        <div class="col-sm-4">          
          <label for="email">Email</label>
          <input id="email" type="email" name="email" value={{ session['email'] }}>
        </div>
        <br>
        <div class="col-sm-4">
          <label for="password">Password</label>
          <input type="password" name="password" id="password">
        </div>
        <br>
        <button role="submit" class="btn btn-primary">Update</button>
      </form>
      </div>
      <hr>
      <div class="row">
        <div class="col-sm-4">
          <p class="mb-0">Saved Jobs:</p>
          {# <h5>{{ user.votes }}</h5> #}
        </div>
        <div class="col-sm-4">
          <p class="mb-0">Subscriptions</p>
          {# <h5>{{ user.subscriptions }}</h5> #}
        </div>
      </div>      
      <hr>
      <div class="container">
        <h5>Transcript</h5>
        <form action="./upload_transcript" method="POST" id="transcript_form" enctype="multipart/form-data">
          <label role="button" for="transcript" class="btn btn-primary">Upload Transcript</label>
          <input  class="" type="file" id="transcript" name="transcript" accept=".txt, .pdf" placeholder=""/>
        </form>
        <br>
        {% set transcript = 'user_files/' ~ session['transcript'] %}
        <a role="button" class="btn btn-secondary" href={{ url_for('static', filename=transcript ) }} download={{ session['transcript'] }}>Download Transcript</a>
        <br>
        <br>
        <h5>Resume</h5>
        <form action="./upload_resume" method="POST" id="resume_form" enctype="multipart/form-data">
          <label role="button" for="resume" class="btn btn-primary">Upload Resume</label>
          <input type="file" id="resume" name="resume" accept=".txt, .pdf"/>   
        </form>
        <br>
        {% set resume = 'user_files/' ~ session['resume'] %}
        <a role="button" class="btn btn-secondary" href={{ url_for('static', filename=resume ) }} download={{ session['resume'] }}>Download Resume</a>       
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
<script>
  let u_transcript = document.getElementById('transcript');
  let u_resume = document.getElementById('resume');
  let t_form = document.getElementById('transcript_form');
  let r_form = document.getElementById('resume_form');

  u_transcript.addEventListener('change', () => {
    t_form.submit();
  });

  u_resume.addEventListener('change', () => {
    r_form.submit();
  });
</script>
{% endblock %}